{# This layout inherits from the base layout #}
{% extends "base.njk" %}

{# Define the content that goes into the 'main' section of base.njk #}
{% block content %}
<article class="blog-post" id="post-{{ page.fileSlug }}">
    <header class="blog-post__header">
        {# --- Use variables from front matter --- #}
        <h1>{{ title }}</h1>
        {% if subtitle %}
        <p class="blog-post__subtitle">{{ subtitle }}</p>
        {% endif %}

        {% if summary %}
        <div class="blog-post__summary">
            {# Assuming summary might contain paragraphs or basic HTML #}
            {{ summary | safe }}
        </div>
        {% endif %}

        {# Check if headerImage data exists in front matter #}
        {% if headerImage and headerImage.src %}
        <figure class="section-image">
            <img src="{{ headerImage.src }}" alt="{{ headerImage.alt or '' }}">
            {% if headerImage.caption %}
            <figcaption>{{ headerImage.caption }}</figcaption>
            {% endif %}
        </figure>
        {% endif %}
    </header>

    {# Check if 'sections' array exists and has items #}
    {% if sections and sections.length > 0 %}
    <div class="blog-sections">
        {# --- Loop through the 'sections' array from front matter --- #}
        {% for section in sections %}
        <section class="blog-section" id="section-{{ loop.index }}">
            {% if section.heading %}
            <h2>{{ section.heading }}</h2>
            {% endif %}

            {% if section.text %}
            <div class="section-text">
                {# Assuming section.text might contain paragraphs or basic HTML #}
                {{ section.text | safe }}
            </div>
            {% endif %}

            {% if section.image and section.image.src %}
            <figure class="section-image">
                <img src="{{ section.image.src }}" alt="{{ section.image.alt or '' }}">
                {% if section.image.caption %}
                <figcaption>{{ section.image.caption }}</figcaption>
                {% endif %}
            </figure>
            {% endif %}
        </section>
        {% endfor %}
        {# --- End of loop --- #}

        {# Include the optional conclusion section if it exists #}
        {% if conclusion and conclusion.heading %}
          <section class="blog-section blog-section--conclusion" id="section-conclusion">
              <h2>{{ conclusion.heading }}</h2>
              {% if conclusion.text %}
              <div class="section-text">
                {{ conclusion.text | safe }}
              </div>
              {% endif %}
          </section>
        {% endif %}

    </div> <!-- /.blog-sections -->
    {% endif %}

</article> <!-- /.blog-post -->
{% endblock %}