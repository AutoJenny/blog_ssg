<h1>Technical Briefing: AutoJenny/blog_ssg Project</h1>
<h2>1. Overview</h2>
<p>This document provides a technical overview of the <code>AutoJenny/blog_ssg</code> GitHub repository. The project is a static site generator (SSG) setup for building and deploying a blog, intended for the website <code>clan.com</code>. It utilizes Eleventy (11ty) as its core engine, supplemented by Python scripts for auxiliary tasks like deployment and image processing, and includes a local Flask-based admin interface for viewing site data.</p>
<h2>2. Technology Stack</h2>
<ul>
<li><strong>Core SSG:</strong> Node.js, Eleventy (11ty)</li>
<li><strong>Configuration:</strong> JavaScript (<code>.eleventy.js</code>)</li>
<li><strong>Templating:</strong> Nunjucks (<code>.njk</code>), Markdown (<code>.md</code>)</li>
<li><strong>Content:</strong> Markdown files with YAML Front Matter</li>
<li><strong>Data Management:</strong> JSON (<code>_data/</code>), JavaScript (<code>*.11tydata.js</code>)</li>
<li><strong>Styling:</strong> CSS (<code>css/</code>)</li>
<li><strong>Node.js Dependencies:</strong> Managed via <code>package.json</code> / <code>package-lock.json</code> (e.g., <code>@11ty/eleventy</code>, <code>luxon</code>, <code>markdown-it</code>, <code>@11ty/eleventy-img</code>)</li>
<li><strong>Auxiliary Scripting:</strong> Python 3</li>
<li><strong>Admin Interface:</strong> Python 3, Flask</li>
<li><strong>Python Dependencies (for scripts/app):</strong> Pillow (watermarking), Paramiko (SFTP), Requests, Flask, python-frontmatter (likely required based on usage).</li>
</ul>
<h2>3. Project Structure Highlights</h2>
<ul>
<li><code>.eleventy.js</code>: <strong>Central Eleventy configuration file.</strong> Defines build behaviour, plugins, collections, filters, shortcodes, and asset handling.</li>
<li><code>_data/</code>: Global JSON data files (e.g., <code>authors.json</code>, <code>image_library.json</code>, <code>syndication.json</code>).</li>
<li><code>_includes/</code>: Reusable Nunjucks template partials (e.g., <code>base.njk</code>, <code>post.njk</code>).</li>
<li><code>_site/</code>: <strong>Output directory</strong> for the generated static site (specified in <code>.gitignore</code>).</li>
<li><code>css/</code>: Source CSS files. Copied directly to <code>_site/css/</code> via passthrough rules.</li>
<li><code>docs/</code>: Markdown files containing project planning and documentation. Copied to <code>_site/docs/</code>.</li>
<li><code>images/</code>: Source image assets. Copied directly to <code>_site/images/</code> via passthrough rules. Also processed by the <code>image</code> shortcode.</li>
<li><code>posts/</code>: Blog post content (Markdown <code>.md</code> files) and associated Eleventy data files (<code>*.11tydata.js/.json</code>).</li>
<li><code>scripts/</code>: Contains auxiliary Python scripts (<code>watermark_images.py</code>, <code>post_to_clan.py</code>).</li>
<li><code>templates/</code>: Contains Nunjucks templates, including those used by the Flask admin app (<code>admin_index.html</code>, <code>admin_post_detail.html</code>). Copied to <code>_site/</code>.</li>
<li><code>app.py</code>: A Flask application providing a local admin interface.</li>
<li><code>index.njk</code>: Nunjucks template for the site's homepage.</li>
<li><code>package.json</code>: Node.js project definition, dependencies, and run scripts (<code>start</code>, <code>build</code>).</li>
<li><code>.gitignore</code>: Specifies files/directories ignored by Git (e.g., <code>node_modules/</code>, <code>_site/</code>).</li>
</ul>
<h2>4. Core Build Process (Eleventy via <code>.eleventy.js</code>)</h2>
<ul>
<li><strong>Configuration:</strong> Centralized in <code>.eleventy.js</code>.</li>
<li><strong>Input/Output:</strong> Reads from root (<code>./</code>), outputs to <code>_site/</code>.</li>
<li><strong>Passthrough Copy:</strong> Copies <code>images/</code>, <code>css/</code>, <code>docs/</code>, <code>templates/admin*</code>, <code>syndication_plan/index.html</code> directly to the <code>_site</code> directory.</li>
<li><strong>Template Engines:</strong> Processes <code>.njk</code> (Nunjucks) and <code>.md</code> (Markdown) files.</li>
<li><strong>Markdown:</strong> Uses <code>markdown-it</code> with HTML enabled and <code>markdown-it-anchor</code> for heading links.</li>
<li><strong>Collections:</strong>
<ul>
<li><code>posts</code>: Creates a date-sorted (desc) array of all items tagged <code>posts</code>.</li>
<li><code>tagList</code>: Creates a unique, sorted list of all tags used.</li>
</ul>
</li>
<li><strong>Filters:</strong>
<ul>
<li><code>readableDate</code>: User-friendly date format (e.g., &quot;Jul 22, 2024&quot;).</li>
<li><code>htmlDateString</code>: ISO date format for <code>&lt;time&gt;</code> elements (e.g., &quot;2024-07-22&quot;).</li>
<li><code>head</code>: Returns the first N items of an array.</li>
<li><code>syndicationLinks</code>: Placeholder for future syndication link processing.</li>
</ul>
</li>
<li><strong>Shortcodes:</strong>
<ul>
<li><code>image</code>: Uses <code>@11ty/eleventy-img</code> to generate responsive <code>&lt;picture&gt;</code> elements with multiple sizes (e.g., 300, 600, 900px) and formats (AVIF, WebP, JPEG) from source images in <code>images/</code>. Includes lazy loading and async decoding attributes.</li>
</ul>
</li>
<li><strong>Environment:</strong> Uses <code>process.env.ELEVENTY_ENV</code> (set in <code>npm run build</code>) for environment-specific actions.</li>
</ul>
<h2>5. Auxiliary Components &amp; Workflows</h2>
<ul>
<li><strong>Admin Interface (<code>app.py</code>):</strong>
<ul>
<li>A <strong>Flask application</strong> providing a <strong>local, read-only</strong> web interface.</li>
<li>Run via <code>python app.py</code>.</li>
<li>Routes include <code>/</code> (dashboard showing data from <code>_data/*.json</code>), <code>/posts/&lt;slug&gt;</code> (detailed post view), and simple API endpoints (<code>/api/workflow</code>, <code>/api/reload-data</code>).</li>
<li>Uses templates from <code>templates/admin*.html</code>.</li>
<li>Useful for viewing site status, data, and post content without starting the full Eleventy build.</li>
</ul>
</li>
<li><strong>Image Watermarking (<code>scripts/watermark_images.py</code>):</strong>
<ul>
<li>A Python script using <code>Pillow</code>.</li>
<li>Adds a text watermark to images found in <code>images/posts/</code>.</li>
<li>Intended as a <strong>manual pre-processing step</strong> before running the Eleventy build.</li>
</ul>
</li>
<li><strong>Deployment (<code>scripts/post_to_clan.py</code>):</strong>
<ul>
<li>A Python script using <code>Paramiko</code> for <strong>SFTP deployment</strong>.</li>
<li>Connects to a remote server (presumably hosting <code>clan.com</code>).</li>
<li>Synchronizes the contents of the local <code>_site/</code> directory (generated by <code>npm run build</code>) to the specified remote directory.</li>
<li><strong>Security Consideration:</strong> How SSH/SFTP credentials (host, user, password/key) are managed is critical. Avoid hardcoding credentials; prefer SSH keys or environment variables.</li>
</ul>
</li>
<li><strong>Development Workflow:</strong>
<ol>
<li>Edit content/templates.</li>
<li>Run <code>npm start</code> for local development server with live reload (<code>http://localhost:8080</code> typically).</li>
<li>View admin interface via <code>python app.py</code> (runs independently on a different port, e.g., 5000).</li>
</ol>
</li>
<li><strong>Deployment Workflow:</strong>
<ol>
<li>Optionally run <code>python scripts/watermark_images.py</code> if needed.</li>
<li>Run <code>npm run build</code> to generate the production site in <code>_site/</code>.</li>
<li>Run <code>python scripts/post_to_clan.py</code> to upload <code>_site/</code> contents to the server.</li>
</ol>
</li>
</ul>
<h2>6. Documentation &amp; Planning</h2>
<ul>
<li>The <code>docs/</code> directory contains Markdown files outlining plans and design decisions for various aspects of the project (image system, admin interface, post creation, syndication). These are valuable for understanding project history and intent.</li>
</ul>
<h2>7. Key Files Quick Reference</h2>
<ul>
<li><code>.eleventy.js</code>: Core build configuration.</li>
<li><code>package.json</code>: Node.js dependencies and scripts (<code>start</code>, <code>build</code>).</li>
<li><code>app.py</code>: Flask admin interface application.</li>
<li><code>scripts/post_to_clan.py</code>: Deployment script.</li>
<li><code>_data/</code>: Global site data.</li>
<li><code>_includes/</code>: Reusable template code.</li>
<li><code>posts/</code>: Blog content.</li>
</ul>
