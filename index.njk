{% extends "base.njk" %}

{# Define specific title for the home page #}
{% set title = "CLAN.com Blog" %}

{% block content %}
    <h1>{{ title }}</h1>

    {# Check if posts data exists #}
    {% if posts.posts and posts.posts.length > 0 %}
        <ul class="post-list">
            {# Loop through posts (Already sorted by date in posts.json) #}
            {% for post in posts.posts %}
                <li class="post-list-item">
                    <h2><a href="/{{ post.slug }}/">{{ post.title }}</a></h2>
                    
                    {# Post Meta: Date and Author #}
                    <p class="post-meta">
                        {% if post.date %}
                            <span class="post-meta__date">
                                <time datetime="{{ post.date }}">{{ post.date | readableDate }}</time>
                            </span>
                        {% endif %}
                        {% if post.author and authors[post.author] %}
                            <span class="post-meta__separator"> | </span>
                            <span class="post-meta__author">
                                By {{ authors[post.author].name }}
                            </span>
                        {% endif %}
                        {% if post.status.overall %}
                            <span class="post-meta__separator"> | </span>
                            <span class="post-meta__status">
                                Status: {{ post.status.overall | capitalize }}
                            </span>
                        {% endif %}
                    </p>

                    {# Display summary if it exists #}
                    {% if post.summary %}
                        <div class="post-summary">
                            {{ post.summary | safe }}
                        </div>
                    {% endif %}

                    {# Display header image if it exists #}
                    {% if post.headerImage and post.headerImage.src %}
                        <div class="post-header-image">
                            <img src="{{ post.headerImage.src | url }}" 
                                 alt="{{ post.headerImage.alt }}"
                                 {% if post.headerImage.caption %}title="{{ post.headerImage.caption }}"{% endif %}>
                            {% if post.headerImage.caption %}
                                <figcaption>{{ post.headerImage.caption }}</figcaption>
                            {% endif %}
                        </div>
                    {% endif %}
                </li>
            {% endfor %}
        </ul>
    {% else %}
        <p>No blog posts found yet!</p>
    {% endif %}
{% endblock %}